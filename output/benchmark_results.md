# Benchmark Results

| Config | Seq Len | Warmup Steps | d_model |  d_ff | n_layers | num_heads | Status FWD | Status FWD+BWD | Total(s) FWD | Total(s) FWD+BWD | Warmup(s) FWD | Warmup(s) FWD+BWD | Avg/Step(s) FWD | Avg/Step(s) FWD+BWD | Std/Step(s) FWD | Std/Step(s) FWD+BWD |
| :----- | ------: | -----------: | ------: | ----: | -------: | --------: | :--------- | :------------- | -----------: | ---------------: | ------------: | ----------------: | --------------: | ------------------: | --------------: | ------------------: |
| small  |     128 |            0 |     768 |  3072 |       12 |        12 | OK         | OK             |       1.0023 |           1.2453 |             0 |                 0 |          0.0668 |               0.083 |        0.216775 |            0.124395 |
| small  |     128 |            1 |     768 |  3072 |       12 |        12 | OK         | OK             |        0.975 |            1.248 |        0.8252 |            0.5291 |          0.0107 |              0.0513 |         0.00181 |             0.00799 |
| small  |     128 |            5 |     768 |  3072 |       12 |        12 | OK         | OK             |       0.9851 |           1.2351 |        0.8761 |            0.6769 |          0.0109 |              0.0558 |        0.002056 |            0.004872 |
| small  |     256 |            0 |     768 |  3072 |       12 |        12 | OK         | OK             |       1.0414 |           1.2672 |             0 |                 0 |          0.0694 |              0.0845 |        0.215732 |            0.127523 |
| small  |     256 |            1 |     768 |  3072 |       12 |        12 | OK         | OK             |       1.0085 |           1.2514 |         0.825 |            0.5286 |          0.0131 |              0.0516 |        0.003709 |            0.006786 |
| small  |     256 |            5 |     768 |  3072 |       12 |        12 | OK         | OK             |       1.0072 |           1.3504 |        0.8887 |            0.7437 |          0.0119 |              0.0607 |         3.4e-05 |             0.00593 |
| small  |     512 |            0 |     768 |  3072 |       12 |        12 | OK         | OK             |       1.1365 |            1.392 |             0 |                 0 |          0.0758 |              0.0928 |        0.212369 |            0.121347 |
| small  |     512 |            1 |     768 |  3072 |       12 |        12 | OK         | OK             |       1.0731 |           1.3859 |        0.8273 |            0.5344 |          0.0176 |              0.0608 |        0.002892 |            0.002008 |
| small  |     512 |            5 |     768 |  3072 |       12 |        12 | OK         | OK             |        1.101 |           1.3767 |        0.9204 |            0.7638 |          0.0181 |              0.0613 |        0.003814 |            0.001623 |
| small  |    1024 |            0 |     768 |  3072 |       12 |        12 | OK         | OK             |        1.509 |             2.84 |             0 |                 0 |          0.1006 |              0.1893 |        0.205508 |            0.120335 |
| small  |    1024 |            1 |     768 |  3072 |       12 |        12 | OK         | OK             |       1.5142 |           2.8371 |        0.8497 |            0.6225 |          0.0475 |              0.1582 |        0.000623 |            0.000174 |
| small  |    1024 |            5 |     768 |  3072 |       12 |        12 | OK         | OK             |       1.5418 |           2.8312 |        1.0676 |             1.248 |          0.0474 |              0.1583 |        0.000495 |            0.000485 |
| medium |     128 |            0 |    1024 |  4096 |       24 |        16 | OK         | OK             |       1.1948 |           1.9575 |             0 |                 0 |          0.0796 |              0.1305 |        0.221662 |            0.128232 |
| medium |     128 |            1 |    1024 |  4096 |       24 |        16 | OK         | OK             |        1.195 |           1.9319 |        0.8836 |            0.5972 |          0.0222 |              0.0953 |        0.003978 |            0.012665 |
| medium |     128 |            5 |    1024 |  4096 |       24 |        16 | OK         | OK             |       1.2178 |            1.949 |        0.9998 |            0.9369 |          0.0218 |              0.1012 |        0.001429 |             0.00528 |
| medium |     256 |            0 |    1024 |  4096 |       24 |        16 | OK         | OK             |       1.3428 |           2.0675 |             0 |                 0 |          0.0895 |              0.1378 |        0.229779 |            0.126324 |
| medium |     256 |            1 |    1024 |  4096 |       24 |        16 | OK         | OK             |       1.3478 |           2.0783 |        0.9265 |             0.604 |          0.0301 |              0.1053 |        0.006274 |            0.005216 |
| medium |     256 |            5 |    1024 |  4096 |       24 |        16 | OK         | OK             |       1.3606 |            2.112 |        1.0808 |            1.0427 |           0.028 |              0.1069 |        0.001225 |            0.004758 |
| medium |     512 |            0 |    1024 |  4096 |       24 |        16 | OK         | OK             |       1.6291 |           3.1863 |             0 |                 0 |          0.1086 |              0.2124 |        0.225688 |            0.127486 |
| medium |     512 |            1 |    1024 |  4096 |       24 |        16 | OK         | OK             |       1.6152 |           3.1583 |        0.9113 |            0.6598 |          0.0503 |              0.1785 |        0.003004 |            0.002339 |
| medium |     512 |            5 |    1024 |  4096 |       24 |        16 | OK         | OK             |       1.6232 |           3.1381 |        1.1262 |            1.3567 |          0.0497 |              0.1781 |        0.000231 |            0.000944 |
| medium |    1024 |            0 |    1024 |  4096 |       24 |        16 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| medium |    1024 |            1 |    1024 |  4096 |       24 |        16 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| medium |    1024 |            5 |    1024 |  4096 |       24 |        16 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| large  |     128 |            0 |    1280 |  5120 |       36 |        20 | OK         | OK             |       1.5116 |            2.993 |             0 |                 0 |          0.1008 |              0.1995 |        0.229969 |            0.144448 |
| large  |     128 |            1 |    1280 |  5120 |       36 |        20 | OK         | OK             |       1.4998 |           2.9996 |        0.9195 |            0.7097 |          0.0414 |              0.1636 |        0.007115 |            0.005697 |
| large  |     128 |            5 |    1280 |  5120 |       36 |        20 | OK         | OK             |       1.5041 |           2.9977 |        1.1123 |            1.3507 |          0.0392 |              0.1647 |        0.000193 |               0.001 |
| large  |     256 |            0 |    1280 |  5120 |       36 |        20 | OK         | OK             |       1.7686 |           3.6186 |             0 |                 0 |          0.1179 |              0.2412 |        0.231367 |            0.133437 |
| large  |     256 |            1 |    1280 |  5120 |       36 |        20 | OK         | OK             |       1.7756 |           3.6202 |        0.9612 |            0.7216 |          0.0582 |               0.207 |        0.009429 |            0.001389 |
| large  |     256 |            5 |    1280 |  5120 |       36 |        20 | OK         | OK             |       1.7699 |           3.6449 |        1.2078 |            1.5692 |          0.0562 |              0.2076 |        0.001835 |            0.001967 |
| large  |     512 |            0 |    1280 |  5120 |       36 |        20 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| large  |     512 |            1 |    1280 |  5120 |       36 |        20 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| large  |     512 |            5 |    1280 |  5120 |       36 |        20 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| large  |    1024 |            0 |    1280 |  5120 |       36 |        20 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| large  |    1024 |            1 |    1280 |  5120 |       36 |        20 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| large  |    1024 |            5 |    1280 |  5120 |       36 |        20 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| xl     |     128 |            0 |    1600 |  6400 |       48 |        25 | OK         | OOM            |       1.9182 |              nan |             0 |               nan |          0.1279 |                 nan |        0.231533 |                 nan |
| xl     |     128 |            1 |    1600 |  6400 |       48 |        25 | OK         | OOM            |       1.9049 |              nan |        0.9652 |               nan |          0.0671 |                 nan |        0.008872 |                 nan |
| xl     |     128 |            5 |    1600 |  6400 |       48 |        25 | OK         | OOM            |       1.9103 |              nan |        1.2565 |               nan |          0.0654 |                 nan |        0.001968 |                 nan |
| xl     |     256 |            0 |    1600 |  6400 |       48 |        25 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| xl     |     256 |            1 |    1600 |  6400 |       48 |        25 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| xl     |     256 |            5 |    1600 |  6400 |       48 |        25 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| xl     |     512 |            0 |    1600 |  6400 |       48 |        25 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| xl     |     512 |            1 |    1600 |  6400 |       48 |        25 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| xl     |     512 |            5 |    1600 |  6400 |       48 |        25 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| xl     |    1024 |            0 |    1600 |  6400 |       48 |        25 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| xl     |    1024 |            1 |    1600 |  6400 |       48 |        25 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| xl     |    1024 |            5 |    1600 |  6400 |       48 |        25 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| 2.7B   |     128 |            0 |    2560 | 10240 |       32 |        32 | OK         | OOM            |       2.1486 |              nan |             0 |               nan |          0.1432 |                 nan |         0.22732 |                 nan |
| 2.7B   |     128 |            1 |    2560 | 10240 |       32 |        32 | OK         | OOM            |        2.136 |              nan |         0.955 |               nan |          0.0844 |                 nan |        0.002824 |                 nan |
| 2.7B   |     128 |            5 |    2560 | 10240 |       32 |        32 | OK         | OOM            |       2.1625 |              nan |        1.3247 |               nan |          0.0838 |                 nan |        0.000205 |                 nan |
| 2.7B   |     256 |            0 |    2560 | 10240 |       32 |        32 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| 2.7B   |     256 |            1 |    2560 | 10240 |       32 |        32 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| 2.7B   |     256 |            5 |    2560 | 10240 |       32 |        32 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| 2.7B   |     512 |            0 |    2560 | 10240 |       32 |        32 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| 2.7B   |     512 |            1 |    2560 | 10240 |       32 |        32 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| 2.7B   |     512 |            5 |    2560 | 10240 |       32 |        32 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| 2.7B   |    1024 |            0 |    2560 | 10240 |       32 |        32 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| 2.7B   |    1024 |            1 |    2560 | 10240 |       32 |        32 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
| 2.7B   |    1024 |            5 |    2560 | 10240 |       32 |        32 | OOM        | OOM            |          nan |              nan |           nan |               nan |             nan |                 nan |             nan |                 nan |
