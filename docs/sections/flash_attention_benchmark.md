### Flash Attention Benchmark Results

#### Forward Latency — fp32 (ms)

**d_model = 16**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.058 | 0.015 | 3.79x |
| 256 | 0.058 | 0.019 | 3.04x |
| 512 | 0.072 | 0.027 | 2.71x |
| 1024 | 0.071 | 0.052 | 1.38x |
| 2048 | 0.158 | 0.075 | 2.09x |
| 4096 | 0.588 | 0.158 | 3.73x |
| 8192 | 2.245 | 0.414 | 5.42x |
| 16384 | 8.226 | 1.314 | 6.26x |
| 32768 | 36.504 | 4.471 | 8.17x |
| 65536 | OOM | 17.054 | — |

**d_model = 32**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.061 | 0.017 | 3.69x |
| 256 | 0.062 | 0.022 | 2.83x |
| 512 | 0.067 | 0.033 | 2.04x |
| 1024 | 0.073 | 0.054 | 1.36x |
| 2048 | 0.161 | 0.099 | 1.62x |
| 4096 | 0.614 | 0.205 | 2.99x |
| 8192 | 2.357 | 0.513 | 4.59x |
| 16384 | 8.645 | 1.642 | 5.26x |
| 32768 | 38.162 | 5.548 | 6.88x |
| 65536 | OOM | 20.456 | — |

**d_model = 64**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.060 | 0.018 | 3.31x |
| 256 | 0.072 | 0.025 | 2.85x |
| 512 | 0.072 | 0.037 | 1.95x |
| 1024 | 0.085 | 0.062 | 1.37x |
| 2048 | 0.191 | 0.118 | 1.63x |
| 4096 | 0.724 | 0.256 | 2.83x |
| 8192 | 2.803 | 0.662 | 4.23x |
| 16384 | 10.724 | 2.193 | 4.89x |
| 32768 | 45.252 | 7.499 | 6.03x |
| 65536 | OOM | 28.908 | — |

**d_model = 128**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.056 | 0.020 | 2.86x |
| 256 | 0.067 | 0.027 | 2.45x |
| 512 | 0.072 | 0.043 | 1.70x |
| 1024 | 0.111 | 0.074 | 1.50x |
| 2048 | 0.249 | 0.144 | 1.72x |
| 4096 | 0.958 | 0.339 | 2.82x |
| 8192 | 3.748 | 1.051 | 3.57x |
| 16384 | 14.540 | 3.508 | 4.14x |
| 32768 | 60.180 | 12.577 | 4.79x |
| 65536 | OOM | 53.697 | — |

#### Backward Latency — fp32 (ms)

**d_model = 16**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.107 | 0.165 | 0.65x |
| 256 | 0.118 | 0.171 | 0.69x |
| 512 | 0.134 | 0.177 | 0.76x |
| 1024 | 0.170 | 0.184 | 0.92x |
| 2048 | 0.230 | 0.262 | 0.88x |
| 4096 | 0.819 | 0.558 | 1.47x |
| 8192 | 3.093 | 1.466 | 2.11x |
| 16384 | 12.172 | 5.193 | 2.34x |
| 32768 | 48.466 | 18.714 | 2.59x |
| 65536 | OOM | 71.993 | — |

**d_model = 32**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.122 | 0.168 | 0.73x |
| 256 | 0.122 | 0.166 | 0.74x |
| 512 | 0.147 | 0.177 | 0.83x |
| 1024 | 0.132 | 0.190 | 0.69x |
| 2048 | 0.236 | 0.265 | 0.89x |
| 4096 | 0.842 | 0.570 | 1.48x |
| 8192 | 3.068 | 1.565 | 1.96x |
| 16384 | 12.761 | 5.671 | 2.25x |
| 32768 | 50.409 | 20.580 | 2.45x |
| 65536 | OOM | 79.770 | — |

**d_model = 64**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.121 | 0.166 | 0.73x |
| 256 | 0.143 | 0.179 | 0.80x |
| 512 | 0.132 | 0.194 | 0.68x |
| 1024 | 0.133 | 0.189 | 0.70x |
| 2048 | 0.291 | 0.357 | 0.82x |
| 4096 | 1.084 | 0.804 | 1.35x |
| 8192 | 4.198 | 2.976 | 1.41x |
| 16384 | 16.652 | 9.772 | 1.70x |
| 32768 | 64.851 | 35.373 | 1.83x |
| 65536 | OOM | 146.229 | — |

**d_model = 128**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.115 | 0.165 | 0.70x |
| 256 | 0.160 | 0.179 | 0.89x |
| 512 | 0.164 | 0.272 | 0.60x |
| 1024 | 0.164 | 0.254 | 0.65x |
| 2048 | 0.451 | 0.543 | 0.83x |
| 4096 | 1.612 | 1.394 | 1.16x |
| 8192 | 5.986 | 4.569 | 1.31x |
| 16384 | 24.174 | 18.326 | 1.32x |
| 32768 | 93.975 | 67.608 | 1.39x |
| 65536 | OOM | 261.649 | — |

#### End-to-End Latency — fp32 (ms)

**d_model = 16**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.406 | 0.390 | 1.04x |
| 256 | 0.433 | 0.378 | 1.15x |
| 512 | 0.465 | 0.409 | 1.14x |
| 1024 | 0.516 | 0.394 | 1.31x |
| 2048 | 0.484 | 0.417 | 1.16x |
| 4096 | 1.420 | 0.667 | 2.13x |
| 8192 | 5.353 | 1.861 | 2.88x |
| 16384 | 20.386 | 6.513 | 3.13x |
| 32768 | 85.024 | 23.092 | 3.68x |
| 65536 | OOM | 90.568 | — |

**d_model = 32**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.474 | 0.378 | 1.25x |
| 256 | 0.438 | 0.394 | 1.11x |
| 512 | 0.476 | 0.391 | 1.22x |
| 1024 | 0.463 | 0.404 | 1.15x |
| 2048 | 0.477 | 0.419 | 1.14x |
| 4096 | 1.468 | 0.754 | 1.95x |
| 8192 | 5.440 | 2.078 | 2.62x |
| 16384 | 21.423 | 7.266 | 2.95x |
| 32768 | 88.584 | 25.950 | 3.41x |
| 65536 | OOM | 100.027 | — |

**d_model = 64**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.437 | 0.374 | 1.17x |
| 256 | 0.493 | 0.397 | 1.24x |
| 512 | 0.505 | 0.425 | 1.19x |
| 1024 | 0.462 | 0.399 | 1.16x |
| 2048 | 0.507 | 0.458 | 1.11x |
| 4096 | 1.823 | 1.072 | 1.70x |
| 8192 | 7.023 | 3.256 | 2.16x |
| 16384 | 27.325 | 11.381 | 2.40x |
| 32768 | 110.509 | 41.200 | 2.68x |
| 65536 | OOM | 161.908 | — |

**d_model = 128**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.438 | 0.383 | 1.14x |
| 256 | 0.478 | 0.395 | 1.21x |
| 512 | 0.406 | 0.405 | 1.00x |
| 1024 | 0.461 | 0.404 | 1.14x |
| 2048 | 0.718 | 0.675 | 1.06x |
| 4096 | 2.590 | 1.753 | 1.48x |
| 8192 | 9.758 | 5.547 | 1.76x |
| 16384 | 38.682 | 20.159 | 1.92x |
| 32768 | 153.742 | 73.957 | 2.08x |
| 65536 | OOM | 304.008 | — |

#### Forward Latency — bf16 (ms)

**d_model = 16**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.065 | 0.014 | 4.50x |
| 256 | 0.082 | 0.018 | 4.49x |
| 512 | 0.067 | 0.023 | 2.95x |
| 1024 | 0.069 | 0.036 | 1.92x |
| 2048 | 0.109 | 0.062 | 1.75x |
| 4096 | 0.390 | 0.119 | 3.28x |
| 8192 | 1.520 | 0.308 | 4.93x |
| 16384 | 4.875 | 0.914 | 5.34x |
| 32768 | 19.436 | 3.287 | 5.91x |
| 65536 | 80.681 | 12.434 | 6.49x |

**d_model = 32**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.068 | 0.017 | 3.98x |
| 256 | 0.068 | 0.023 | 2.96x |
| 512 | 0.070 | 0.034 | 2.02x |
| 1024 | 0.068 | 0.058 | 1.17x |
| 2048 | 0.109 | 0.106 | 1.03x |
| 4096 | 0.390 | 0.212 | 1.84x |
| 8192 | 1.520 | 0.478 | 3.18x |
| 16384 | 4.906 | 1.295 | 3.79x |
| 32768 | 19.556 | 4.533 | 4.31x |
| 65536 | 81.182 | 16.413 | 4.95x |

**d_model = 64**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.065 | 0.017 | 3.90x |
| 256 | 0.142 | 0.022 | 6.38x |
| 512 | 0.068 | 0.033 | 2.08x |
| 1024 | 0.061 | 0.055 | 1.12x |
| 2048 | 0.111 | 0.099 | 1.12x |
| 4096 | 0.399 | 0.205 | 1.95x |
| 8192 | 1.561 | 0.496 | 3.14x |
| 16384 | 5.011 | 1.552 | 3.23x |
| 32768 | 19.884 | 5.247 | 3.79x |
| 65536 | 82.544 | 19.176 | 4.30x |

**d_model = 128**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.068 | 0.020 | 3.50x |
| 256 | 0.065 | 0.025 | 2.57x |
| 512 | 0.062 | 0.040 | 1.55x |
| 1024 | 0.064 | 0.066 | 0.96x |
| 2048 | 0.117 | 0.126 | 0.94x |
| 4096 | 0.418 | 0.267 | 1.57x |
| 8192 | 1.605 | 0.659 | 2.44x |
| 16384 | 5.206 | 2.135 | 2.44x |
| 32768 | 20.675 | 7.342 | 2.82x |
| 65536 | 88.074 | 27.879 | 3.16x |

#### Backward Latency — bf16 (ms)

**d_model = 16**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.135 | 0.193 | 0.70x |
| 256 | 0.133 | 0.178 | 0.75x |
| 512 | 0.121 | 0.169 | 0.72x |
| 1024 | 0.137 | 0.180 | 0.76x |
| 2048 | 0.139 | 0.182 | 0.76x |
| 4096 | 0.447 | 0.300 | 1.49x |
| 8192 | 1.470 | 0.841 | 1.75x |
| 16384 | 5.427 | 3.022 | 1.80x |
| 32768 | 23.053 | 10.909 | 2.11x |
| 65536 | 88.720 | 42.799 | 2.07x |

**d_model = 32**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.128 | 0.185 | 0.69x |
| 256 | 0.131 | 0.178 | 0.74x |
| 512 | 0.127 | 0.167 | 0.76x |
| 1024 | 0.137 | 0.184 | 0.75x |
| 2048 | 0.128 | 0.186 | 0.68x |
| 4096 | 0.416 | 0.286 | 1.46x |
| 8192 | 1.434 | 0.812 | 1.76x |
| 16384 | 5.377 | 2.984 | 1.80x |
| 32768 | 22.244 | 10.758 | 2.07x |
| 65536 | 89.037 | 41.849 | 2.13x |

**d_model = 64**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.128 | 0.166 | 0.77x |
| 256 | 0.142 | 0.172 | 0.82x |
| 512 | 0.121 | 0.171 | 0.71x |
| 1024 | 0.127 | 0.195 | 0.65x |
| 2048 | 0.129 | 0.185 | 0.70x |
| 4096 | 0.428 | 0.387 | 1.10x |
| 8192 | 1.469 | 1.129 | 1.30x |
| 16384 | 5.495 | 4.136 | 1.33x |
| 32768 | 22.751 | 15.045 | 1.51x |
| 65536 | 90.811 | 60.100 | 1.51x |

**d_model = 128**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.133 | 0.181 | 0.73x |
| 256 | 0.120 | 0.166 | 0.72x |
| 512 | 0.113 | 0.167 | 0.68x |
| 1024 | 0.127 | 0.182 | 0.70x |
| 2048 | 0.133 | 0.250 | 0.53x |
| 4096 | 0.461 | 0.606 | 0.76x |
| 8192 | 1.548 | 1.884 | 0.82x |
| 16384 | 5.699 | 6.826 | 0.83x |
| 32768 | 23.563 | 26.401 | 0.89x |
| 65536 | 96.677 | 105.184 | 0.92x |

#### End-to-End Latency — bf16 (ms)

**d_model = 16**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.450 | 0.403 | 1.12x |
| 256 | 0.488 | 0.415 | 1.18x |
| 512 | 0.449 | 0.383 | 1.17x |
| 1024 | 0.469 | 0.405 | 1.16x |
| 2048 | 0.470 | 0.406 | 1.16x |
| 4096 | 0.843 | 0.446 | 1.89x |
| 8192 | 2.989 | 1.194 | 2.50x |
| 16384 | 10.312 | 4.066 | 2.54x |
| 32768 | 42.497 | 14.598 | 2.91x |
| 65536 | 169.147 | 56.405 | 3.00x |

**d_model = 32**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.469 | 0.385 | 1.22x |
| 256 | 0.568 | 0.391 | 1.45x |
| 512 | 0.450 | 0.384 | 1.17x |
| 1024 | 0.474 | 0.400 | 1.18x |
| 2048 | 0.461 | 0.410 | 1.12x |
| 4096 | 0.808 | 0.529 | 1.53x |
| 8192 | 2.955 | 1.356 | 2.18x |
| 16384 | 10.289 | 4.470 | 2.30x |
| 32768 | 41.761 | 15.963 | 2.62x |
| 65536 | 169.458 | 60.772 | 2.79x |

**d_model = 64**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.454 | 0.408 | 1.11x |
| 256 | 0.587 | 0.396 | 1.48x |
| 512 | 0.450 | 0.381 | 1.18x |
| 1024 | 0.457 | 0.419 | 1.09x |
| 2048 | 0.466 | 0.418 | 1.11x |
| 4096 | 0.834 | 0.667 | 1.25x |
| 8192 | 3.035 | 1.764 | 1.72x |
| 16384 | 10.517 | 6.217 | 1.69x |
| 32768 | 42.642 | 22.418 | 1.90x |
| 65536 | 173.428 | 86.300 | 2.01x |

**d_model = 128**

| seq_len | regular | triton_flash | triton vs regular |
| --- | --- | --- | --- |
| 128 | 0.467 | 0.386 | 1.21x |
| 256 | 0.449 | 0.389 | 1.15x |
| 512 | 0.439 | 0.424 | 1.03x |
| 1024 | 0.464 | 0.416 | 1.12x |
| 2048 | 0.467 | 0.425 | 1.10x |
| 4096 | 0.887 | 0.963 | 0.92x |
| 8192 | 3.153 | 2.909 | 1.08x |
| 16384 | 10.931 | 10.075 | 1.09x |
| 32768 | 44.463 | 36.310 | 1.22x |
| 65536 | 184.540 | 144.382 | 1.28x |
