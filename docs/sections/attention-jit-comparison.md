### JIT Performance Comparison

#### Attention

#### Forward Pass Timing

| seq_len | embed_dim | Eager (ms) | JIT (ms) | Speedup |
| ------- | --------- | ---------- | -------- | ------- |
| 256     | 16        | 0.614      | 0.378    | 1.62x   |
| 256     | 32        | 0.613      | 0.300    | 2.04x   |
| 256     | 64        | 0.621      | 0.299    | 2.08x   |
| 256     | 128       | 0.611      | 0.302    | 2.02x   |
| 1024    | 16        | 0.855      | 0.307    | 2.79x   |
| 1024    | 32        | 0.870      | 0.304    | 2.87x   |
| 1024    | 64        | 0.906      | 0.307    | 2.95x   |
| 1024    | 128       | 0.976      | 0.313    | 3.12x   |
| 4096    | 16        | 7.291      | 1.562    | 4.67x   |
| 4096    | 32        | 7.531      | 1.587    | 4.75x   |
| 4096    | 64        | 7.991      | 1.681    | 4.75x   |
| 4096    | 128       | 8.978      | 1.972    | 4.55x   |
| 8192    | 16        | 26.386     | 5.794    | 4.55x   |
| 8192    | 32        | 27.270     | 5.888    | 4.63x   |
| 8192    | 64        | 29.319     | 6.401    | 4.58x   |
| 8192    | 128       | 33.296     | 7.348    | 4.53x   |
| 16384   | 16        | 105.357    | 27.651   | 3.81x   |
| 16384   | 32        | 109.512    | 28.214   | 3.88x   |
| 16384   | 64        | 117.173    | 30.160   | 3.89x   |
| 16384   | 128       | 132.054    | 33.240   | 3.97x   |

#### Forward + Backward Pass Timing

| seq_len | embed_dim | Eager Fwd (ms) | JIT Fwd (ms) | Fwd Speedup | Eager Bwd (ms) | JIT Bwd (ms) | Bwd Speedup |
| ------- | --------- | -------------- | ------------ | ----------- | -------------- | ------------ | ----------- |
| 256     | 16        | 0.645          | 0.362        | 1.78x       | 1.033          | 0.537        | 1.92x       |
| 256     | 32        | 0.646          | 0.365        | 1.77x       | 0.965          | 0.534        | 1.81x       |
| 256     | 64        | 0.644          | 0.357        | 1.80x       | 0.957          | 0.529        | 1.81x       |
| 256     | 128       | 0.641          | 0.382        | 1.68x       | 0.969          | 0.532        | 1.82x       |
| 1024    | 16        | 0.894          | 0.360        | 2.48x       | 1.851          | 0.530        | 3.49x       |
| 1024    | 32        | 0.908          | 0.363        | 2.50x       | 1.874          | 0.536        | 3.50x       |
| 1024    | 64        | 0.945          | 0.361        | 2.62x       | 1.922          | 0.532        | 3.61x       |
| 1024    | 128       | 1.033          | 0.340        | 3.04x       | 2.030          | 0.564        | 3.60x       |
| 4096    | 16        | 7.333          | 1.576        | 4.65x       | 19.794         | 3.017        | 6.56x       |
| 4096    | 32        | 7.566          | 1.613        | 4.69x       | 20.034         | 3.066        | 6.53x       |
| 4096    | 64        | 8.037          | 1.713        | 4.69x       | 20.536         | 3.206        | 6.41x       |
| 4096    | 128       | 9.003          | 1.974        | 4.56x       | 21.631         | 3.686        | 5.87x       |
| 8192    | 16        | 26.451         | 5.835        | 4.53x       | 72.833         | 12.217       | 5.96x       |
| 8192    | 32        | 27.327         | 5.956        | 4.59x       | 73.621         | 12.318       | 5.98x       |
| 8192    | 64        | 29.262         | 6.459        | 4.53x       | 75.699         | 12.796       | 5.92x       |
| 8192    | 128       | 33.136         | 7.317        | 4.53x       | 79.872         | 14.492       | 5.51x       |
| 16384   | 16        | 105.553        | 27.717       | 3.81x       | 290.584        | 61.811       | 4.70x       |
| 16384   | 32        | 109.471        | 28.115       | 3.89x       | 294.210        | 62.296       | 4.72x       |
| 16384   | 64        | 117.036        | 29.910       | 3.91x       | 301.937        | 64.577       | 4.67x       |
| 16384   | 128       | 132.066        | 32.786       | 4.03x       | 317.067        | 71.577       | 4.43x       |

#### Memory Usage Comparison (Forward + Backward)

| seq_len | embed_dim | Eager (MB) | JIT (MB) | Change |
| ------- | --------- | ---------- | -------- | ------ |
| 256     | 16        | 23.08      | 21.09    | -8.6%  |
| 256     | 32        | 23.84      | 21.85    | -8.4%  |
| 256     | 64        | 25.39      | 23.39    | -7.9%  |
| 256     | 128       | 28.58      | 26.59    | -7.0%  |
| 1024    | 16        | 116.32     | 84.33    | -27.5% |
| 1024    | 32        | 119.33     | 87.33    | -26.8% |
| 1024    | 64        | 125.38     | 93.38    | -25.5% |
| 1024    | 128       | 137.56     | 105.58   | -23.3% |
| 4096    | 16        | 1580.50    | 1068.51  | -32.4% |
| 4096    | 32        | 1592.52    | 1080.53  | -32.2% |
| 4096    | 64        | 1616.56    | 1104.56  | -31.7% |
| 4096    | 128       | 1664.75    | 1152.76  | -30.7% |
| 8192    | 16        | 6248.75    | 4200.77  | -32.8% |
| 8192    | 32        | 6272.77    | 4224.77  | -32.6% |
| 8192    | 64        | 6320.81    | 4272.82  | -32.4% |
| 8192    | 128       | 6417.00    | 4369.01  | -31.9% |
| 16384   | 16        | 24897.25   | 16705.26 | -32.9% |
| 16384   | 32        | 24945.27   | 16753.27 | -32.8% |
| 16384   | 64        | 25041.31   | 16849.32 | -32.7% |
| 16384   | 128       | 25233.50   | 17041.52 | -32.5% |

#### Summary

1. **Time Optimization**:
   - Forward pass: JIT provides **1.6x - 4.8x** speedup
   - Backward pass: JIT provides **1.8x - 6.6x** speedup
   - Speedup increases with seq_len, peaking at seq_len=4096-8192

2. **Memory Optimization**:
   - JIT reduces memory usage by **7% - 33%**
   - Memory savings increase with seq_len
   - For large sequences (seq_len >= 4096), memory savings stabilize at **~32%**

3. **Conclusion**: `torch.compile` optimizes both time and memory through operator fusion, reducing intermediate tensor allocations.
